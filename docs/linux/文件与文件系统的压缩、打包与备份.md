# 文件与文件系统的压缩、打包与备份

## 常见的压缩指令
压缩扩展名： *.tar, *.tar.gz, *.tgz, *.gz, *.Z, *.bz2, *.xz
|||
|---|---|
|*.Z|compress程序压缩的文件|
|*.zip|zip程序压缩的文件|
|*.gz|gzip程序压缩的文件|
|*.bz2|bzip2程序压缩的文件|
|*.xz|xz程序压缩的文件|
|*.tar|tar程序打包的数据，并没有压缩过|
|*.tar.gz|tar程序打包的文件，其中并且经过gzip的压缩|
|*.tar.bz2|tar程序打包的文件，其中并将经过bzip2的压缩|
|*.tar.xz|tar程序打包的文件，其中并且经过xz的压缩|

### gizp, zcat/zmore/zless/zgrep
-gzip
|选项|解释|
|---|---|
|-c|将压缩的数据输出到屏幕上，可透过数据流重导向来处理|
|-d|解压缩的参数|
|-t|用来检验要给压缩文件的一致性（看看文件有无错误）|
|-v|可视显示出原文件/压缩文件的压缩比信息|
|-#|#为数字，代表压缩等级|
||-1：最快，但是压缩比最差|
||-9：最慢，但是压缩比最好|
||默认为-6|
```shell
[root@iZbp13op1xah7j3j1x457dZ tmp]# cp /etc/services .
[root@iZbp13op1xah7j3j1x457dZ tmp]# ls
aliyun_assist_service.sock  services                                                                 tmp
attrtest                    systemd-private-bc591917886f4234b038068d870ce742-chronyd.service-pz5zFc  vscode-typescript0
bashrc                      systemd-private-bc591917886f4234b038068d870ce742-nginx.service-tIjyZz    wtmp
chapter6_1                  test                                                                     wtmp_2
passwd-hd                   testing1                                                                 yum_save_tx.2024-07-23.17-07.wSsOei.yumtx
passwd-so                   testtouch
[root@iZbp13op1xah7j3j1x457dZ tmp]# gzip -v services
services:        79.7% -- replaced with services.gz
[root@iZbp13op1xah7j3j1x457dZ tmp]# ll /etc/services /tmp/services*
-rw-r--r--. 1 root root 670293 Jun  7  2013 /etc/services
-rw-r--r--  1 root root 136088 Aug  2 17:55 /tmp/services.gz
[root@iZbp13op1xah7j3j1x457dZ tmp]#
```
services原本是文本文件，故可以使用zcat/zmore/zless读取，屏幕上会显示services.gz解压缩之后的源文件内容

这里使用zcat 文件的内容输出到zcatservices文件中
```shell
[root@iZbp13op1xah7j3j1x457dZ ~]# zcat /tmp/services.gz > zcatservices
[root@iZbp13op1xah7j3j1x457dZ ~]# 
```
zcatservices部分内容如下
```txt
# /etc/services:
# $Id: services,v 1.55 2013/04/14 ovasik Exp $
#
# Network services, Internet style
# IANA services version: last updated 2013-04-10
#
# Note that it is presently the policy of IANA to assign a single well-known
# port number for both TCP and UDP; hence, most entries here have two entries
# even if the protocol doesn't support UDP operations.
# Updated from RFC 1700, ``Assigned Numbers'' (October 1994).  Not all ports
# are included, only the more common ones.
#
# The latest IANA port assignments can be gotten from
#       http://www.iana.org/assignments/port-numbers
# The Well Known Ports are those from 0 through 1023.
# The Registered Ports are those from 1024 through 49151
# The Dynamic and/or Private Ports are those from 49152 through 65535
#
# Each line describes one service, and is of the form:
#
# service-name  port/protocol  [aliases ...]   [# comment]

tcpmux          1/tcp                           # TCP port service multiplexer
tcpmux          1/udp                           # TCP port service multiplexer
rje             5/tcp                           # Remote Job Entry
rje             5/udp                           # Remote Job Entry
echo            7/tcp
echo            7/udp
discard         9/tcp           sink null
discard         9/udp           sink null
systat          11/tcp          users
systat          11/udp          users
daytime         13/tcp
daytime         13/udp
qotd            17/tcp          quote
qotd            17/udp          quote
msp             18/tcp                          # message send protocol (historic)
msp             18/udp                          # message send protocol (historic)
chargen         19/tcp          ttytst source
chargen         19/udp          ttytst source
ftp-data        20/tcp
ftp-data        20/udp
# 21 is registered to ftp, but also used by fsp
ftp             21/tcp
ftp             21/udp          fsp fspd
ssh             22/tcp                          # The Secure Shell (SSH) Protocol
ssh             22/udp                          # The Secure Shell (SSH) Protocol
telnet          23/tcp
telnet          23/udp
# 24 - private mail system
lmtp            24/tcp                          # LMTP Mail Delivery
lmtp            24/udp                          # LMTP Mail Delivery
smtp            25/tcp          mail
smtp            25/udp          mail
time            37/tcp          timserver
time            37/udp          timserver
rlp             39/tcp          resource        # resource location
rlp             39/udp          resource        # resource location
nameserver      42/tcp          name            # IEN 116
nameserver      42/udp          name            # IEN 116
nicname         43/tcp          whois
nicname         43/udp          whois
tacacs          49/tcp                          # Login Host Protocol (TACACS)
tacacs          49/udp                          # Login Host Protocol (TACACS)
re-mail-ck      50/tcp                          # Remote Mail Checking Protocol
re-mail-ck      50/udp                          # Remote Mail Checking Protocol
domain          53/tcp                          # name-domain server
domain          53/udp
whois++         63/tcp          whoispp
whois++         63/udp          whoispp
bootps          67/tcp                          # BOOTP server
bootps          67/udp
bootpc          68/tcp          dhcpc           # BOOTP client
bootpc          68/udp          dhcpc
tftp            69/tcp
tftp            69/udp
gopher          70/tcp                          # Internet Gopher
gopher          70/udp
netrjs-1        71/tcp                          # Remote Job Service
netrjs-1        71/udp                          # Remote Job Service
netrjs-2        72/tcp                          # Remote Job Service
netrjs-2        72/udp                          # Remote Job Service
netrjs-3        73/tcp                          # Remote Job Service
netrjs-3        73/udp                          # Remote Job Service
```

```shell

[root@iZbp13op1xah7j3j1x457dZ tmp]# ls
aliyun_assist_service.sock  services.gz                                                              tmp
attrtest                    systemd-private-bc591917886f4234b038068d870ce742-chronyd.service-pz5zFc  vscode-typescript0
bashrc                      systemd-private-bc591917886f4234b038068d870ce742-nginx.service-tIjyZz    wtmp
chapter6_1                  test                                                                     wtmp_2
passwd-hd                   testing1                                                                 yum_save_tx.2024-07-23.17-07.wSsOei.yumtx
passwd-so                   testtouch

# 解压缩 也可以使用 gunzip进行解压缩
[root@iZbp13op1xah7j3j1x457dZ tmp]# gzip -d services.gz 
[root@iZbp13op1xah7j3j1x457dZ tmp]# ls
aliyun_assist_service.sock  services                                                                 tmp
attrtest                    systemd-private-bc591917886f4234b038068d870ce742-chronyd.service-pz5zFc  vscode-typescript0
bashrc                      systemd-private-bc591917886f4234b038068d870ce742-nginx.service-tIjyZz    wtmp
chapter6_1                  test                                                                     wtmp_2
passwd-hd                   testing1                                                                 yum_save_tx.2024-07-23.17-07.wSsOei.yumtx
passwd-so                   testtouch
[root@iZbp13op1xah7j3j1x457dZ tmp]#

# -9 压缩比最好 -c 将原本要转成压缩文件的资料内容，输出到屏幕上， 由于使用了 > ,所以将原本输出到屏幕上的内容，输出到这个文件中了。 这个文件就是压缩档
[root@iZbp13op1xah7j3j1x457dZ tmp]# gzip -9 -c services > services.gz
[root@iZbp13op1xah7j3j1x457dZ tmp]# ls
aliyun_assist_service.sock  services                                                                 testtouch
attrtest                    services.gz                                                              tmp
bashrc                      systemd-private-bc591917886f4234b038068d870ce742-chronyd.service-pz5zFc  vscode-typescript0
chapter6_1                  systemd-private-bc591917886f4234b038068d870ce742-nginx.service-tIjyZz    wtmp
passwd-hd                   test                                                                     wtmp_2
passwd-so                   testing1                                                                 yum_save_tx.2024-07-23.17-07.wSsOei.yumtx

# 使用zgrep搜寻关键词，查找压缩文件中的数据，而不需要解压文件。
[root@iZbp13op1xah7j3j1x457dZ tmp]# zgrep -n "http" services.gz 
14:#       http://www.iana.org/assignments/port-numbers
89:http            80/tcp          www www-http    # WorldWideWeb HTTP
90:http            80/udp          www www-http    # HyperText Transfer Protocol
91:http            80/sctp                         # HyperText Transfer Protocol
197:https           443/tcp                         # http protocol over TLS/SSL
198:https           443/udp                         # http protocol over TLS/SSL
199:https           443/sctp                        # http protocol over TLS/SSL
210:gss-http        488/tcp
211:gss-http        488/udp
555:webcache        8080/tcp        http-alt        # WWW caching service
556:webcache        8080/udp        http-alt        # WWW caching service
881:http-mgmt       280/tcp                 # http-mgmt
882:http-mgmt       280/udp                 # http-mgmt
1338:http-rpc-epmap  593/tcp                 # HTTP RPC Ep Map
1339:http-rpc-epmap  593/udp                 # HTTP RPC Ep Map
1392:oob-ws-http     623/tcp                 # DMTF out-of-band web services management protocol
1468:oob-ws-https    664/tcp                 # DMTF out-of-band secure web services management protocol
1614:multiling-http  777/tcp                 # Multiling HTTP
1615:multiling-http  777/udp                 # Multiling HTTP
1632:netconfsoaphttp 832/tcp                 # NETCONF for SOAP over HTTPS
1633:netconfsoaphttp 832/udp                 # NETCONF for SOAP over HTTPS
2004:llsurfup-http   1183/tcp                # LL Surfup HTTP
2005:llsurfup-http   1183/udp                # LL Surfup HTTP
2006:llsurfup-https  1184/tcp                # LL Surfup HTTPS
2007:llsurfup-https  1184/udp                # LL Surfup HTTPS
4288:compaq-https    2381/tcp                # Compaq HTTPS
4289:compaq-https    2381/udp                # Compaq HTTPS
4867:md-cg-http      2688/tcp                # md-cf-http
4868:md-cg-http      2688/udp                # md-cf-http
5182:webemshttp      2851/tcp                # webemshttp
5183:webemshttp      2851/udp                # webemshttp
5687:cardbox-http    3106/tcp                # Cardbox HTTP
5688:cardbox-http    3106/udp                # Cardbox HTTP
5923:dwnmshttp       3227/tcp                # DiamondWave NMS Server
5924:dwnmshttp       3227/udp                # DiamondWave NMS Server
7050:sunlps-http     3816/tcp                # Sun Local Patch Server
7051:sunlps-http     3816/udp                # Sun Local Patch Server
7485:wap-push-http   4035/tcp                # WAP Push OTA-HTTP port
7486:wap-push-http   4035/udp                # WAP Push OTA-HTTP port
7487:wap-push-https  4036/tcp                # WAP Push OTA-HTTP secure
7488:wap-push-https  4036/udp                # WAP Push OTA-HTTP secure
7753:httpx           4180/tcp                # HTTPX
7754:httpx           4180/udp                # HTTPX
8206:appserv-http    4848/tcp                # App Server - Admin HTTP
8207:appserv-http    4848/udp                # App Server - Admin HTTP
8208:appserv-https   4849/tcp                # App Server - Admin HTTPS
8209:appserv-https   4849/udp                # App Server - Admin HTTPS
8731:sgi-esphttp     5554/tcp                # SGI ESP HTTP
8732:sgi-esphttp     5554/udp                # SGI ESP HTTP
8960:wbem-http       5988/tcp                # WBEM CIM-XML (HTTP)
8961:wbem-http       5988/udp                # WBEM CIM-XML (HTTP)
8962:wbem-https      5989/tcp                # WBEM CIM-XML (HTTPS)
8963:wbem-https      5989/udp                # WBEM CIM-XML (HTTPS)
8964:wbem-exp-https  5990/tcp                # WBEM Export HTTPS
8965:wbem-exp-https  5990/udp                # WBEM Export HTTPS
9169:sun-sr-https    6443/tcp                # Service Registry Default HTTPS Domain
9170:sun-sr-https    6443/udp                # Service Registry Default HTTPS Domain
9183:sun-sr-http     6480/tcp                # Service Registry Default HTTP Domain
9184:sun-sr-http     6480/udp                # Service Registry Default HTTP Domain
9332:plysrv-http     6770/tcp                # PolyServe http
9333:plysrv-http     6770/udp                # PolyServe http
9334:plysrv-https    6771/tcp                # PolyServe https
9335:plysrv-https    6771/udp                # PolyServe https
9343:smc-http        6788/tcp                # SMC-HTTP
9344:smc-http        6788/udp                # SMC-HTTP
9345:smc-https       6789/tcp                # SMC-HTTPS
9346:smc-https       6789/udp                # SMC-HTTPS
9358:netmo-http      6842/tcp                # Netmo HTTP
9359:netmo-http      6842/udp                # Netmo HTTP
9544:oracleas-https  7443/tcp                # Oracle Application Server HTTPS
9545:oracleas-https  7443/udp                # Oracle Application Server HTTPS
9592:soap-http       7627/tcp                # SOAP Service Port
9593:soap-http       7627/udp                # SOAP Service Port
9612:sun-user-https  7677/tcp                # Sun App Server - HTTPS
9613:sun-user-https  7677/udp                # Sun App Server - HTTPS
9777:radan-http      8088/tcp                # Radan HTTP
9778:radan-http      8088/udp                # Radan HTTP
9844:synapse-nhttps  8243/tcp                # Synapse Non Blocking HTTPS
9845:synapse-nhttps  8243/udp                # Synapse Non Blocking HTTPS
9848:synapse-nhttp   8280/tcp                # Synapse Non Blocking HTTP
9849:synapse-nhttp   8280/udp                # Synapse Non Blocking HTTP
9895:pcsync-https    8443/tcp                # PCsync HTTPS
9896:pcsync-https    8443/udp                # PCsync HTTPS
9897:pcsync-http     8444/tcp                # PCsync HTTP
9898:pcsync-http     8444/udp                # PCsync HTTP
9955:ultraseek-http  8765/tcp                # Ultraseek HTTP
9956:ultraseek-http  8765/udp                # Ultraseek HTTP
9998:manyone-http    8910/tcp                # manyone-http
9999:manyone-http    8910/udp                # manyone-http
10012:http-wmap       8990/tcp                # webmail HTTP service
10013:http-wmap       8990/udp                # webmail HTTP service
10014:https-wmap      8991/tcp                # webmail HTTPS service
10015:https-wmap      8991/udp                # webmail HTTPS service
10165:armcenterhttp   9294/tcp                # ARMCenter http Service
10166:armcenterhttp   9294/udp                # ARMCenter http Service
10167:armcenterhttps  9295/tcp                # ARMCenter https Service
10168:armcenterhttps  9295/udp                # ARMCenter https Service
10203:tungsten-https  9443/tcp                # WSO2 Tungsten HTTPS
10204:tungsten-https  9443/udp                # WSO2 Tungsten HTTPS
10268:tungsten-http   9762/tcp                # WSO2 Tungsten HTTP
10269:tungsten-http   9762/udp                # WSO2 Tungsten HTTP
10642:amt-soap-http   16992/tcp               # Intel(R) AMT SOAP/HTTP
10643:amt-soap-http   16992/udp               # Intel(R) AMT SOAP/HTTP
10644:amt-soap-https  16993/tcp               # Intel(R) AMT SOAP/HTTPS
10645:amt-soap-https  16993/udp               # Intel(R) AMT SOAP/HTTPS
10743:commtact-http   20002/tcp               # Commtact HTTP
10744:commtact-http   20002/udp               # Commtact HTTP
10745:commtact-https  20003/tcp               # Commtact HTTPS
10746:commtact-https  20003/udp               # Commtact HTTPS
10877:tcc-http        24680/tcp               # TCC User HTTP Service
10878:tcc-http        24680/udp               # TCC User HTTP Service
10938:kopek-httphead  27504/tcp               # Kopek HTTP Head Port
10939:kopek-httphead  27504/udp               # Kopek HTTP Head Port
[root@iZbp13op1xah7j3j1x457dZ tmp]# 
```
- bzip2， bzcat/bzmore/bzless/bzgrep
bzip2的压缩比比gzip压缩比好，用法与gzip类似

|选项|解释|
|---|---|
|-c|将压缩的过程产生的数据输出到屏幕上|
|-d|解压缩的参数|
|-k|保留源文件，而不会删除原始的文件|
|-z|压缩的参数|
|-v|可以显示出原文件/压缩文件案的压缩比等信息|
|-#|与gzip类似|

- xz, xzcat/xzmore/xzless/xzgrep

|选项|解释|
|---|---|
|-d|解压缩|
|-t|测试压缩文件的完整性，看有没有错误|
|-l|显示出压缩文件的相关信息|
|-k|保留原本的文件不删除|
|-c|将数据输出到屏幕上|
|-#|压缩比|

## 打包指令 tar
将多个目录或文件打包成一个大文件


